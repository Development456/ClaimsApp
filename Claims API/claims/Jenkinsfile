pipeline {
	agent none
	environment{
	   DOCKERHUB_CREDENTAILS= credentails('Dockerhub')
	   }
  stages {
  	stage('Maven Install') {
    	agent {
      	docker {
        	image 'maven'
        }
      }
      steps {
      	sh 'mvn clean install'
      }
    }
    stage('Docker Build') {
    	agent any
      steps {
      script{
      dir('Claims API/claims'){
      
      	sh 'docker build -t pvattipalli/claims-docker.jar .'
      	}
      	}
      }
      stage('login'){
      steps{
      sh 'echo $DOCKERHUB_CREDENTAILS_PSW | docker login -u $DOCKERHUB_CREDENTAILS_USR --password-stdio'}
    }
  }
  stage('push'){
  steps{
  sh 'docker push pvattipalli/claims-docker.jar'}
}
}
}
